#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–æ—Ç–∞

BOT_NAME="tournament_bot"

echo "========================================"
echo "üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ENAS Tournament Bot"
echo "========================================"
echo ""

# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
echo "üîç –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞:"
systemctl is-active --quiet $BOT_NAME && echo "‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç" || echo "‚ùå –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
echo ""

# –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
echo "‚è±Ô∏è  –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:"
systemctl show $BOT_NAME --property=ActiveEnterTimestamp | cut -d= -f2
echo ""

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –∏ RAM
echo "üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:"
ps aux | grep "python.*main.py" | grep -v grep | awk '{print "CPU: "$3"% | RAM: "$4"%"}'
echo ""

# –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
echo "üíæ –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:"
du -h /home/ENASGame_bot_2025/tournament_bot.db 2>/dev/null || echo "–ë–î –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
echo ""

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
echo "üìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤:"
journalctl -u $BOT_NAME -n 5 --no-pager
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É
echo "üåê –ò–Ω—Ç–µ—Ä–Ω–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ:"
ping -c 1 google.com &>/dev/null && echo "‚úÖ OK" || echo "‚ùå –ù–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"
echo ""

# –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
echo "üíΩ –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ:"
df -h / | tail -1 | awk '{print "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: "$3" –∏–∑ "$2" ("$5")"}'
echo ""

echo "========================================"
echo "–ü–æ–ª–Ω—ã–π –ª–æ–≥: sudo journalctl -u $BOT_NAME -f"
echo "========================================"
